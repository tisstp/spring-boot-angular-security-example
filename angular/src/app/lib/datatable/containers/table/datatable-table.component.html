<!-- region datatable header: search, size show item -->
<datatable-header
  [showSearch]="showSearch"
  [isDisabled]="isDisabled"
  (onSearch)="onSearch($event)"
  (onChangedSizeOfPage)="onChangedSizeOfPage($event)"
></datatable-header>
<!-- endregion  -->

<!-- region datatable body: table container -->
<div [ngClass]="tableContainerStyleClass" [formGroup]="checkboxForm">
  <div *ngIf="isLoading" class="d-flex datatable-loading">
    <div class="align-self-center w-100 text-center h2">Loading...</div>
  </div>

  <table [ngClass]="tableStyleClass">
    <!-- region table head -->
    <thead [ngClass]="theadStyleClass">
      <tr *ngIf="!headerTemplate">
        <ng-container *ngFor="let col of columns">
          <!-- method 1: default -->
          <ng-container *ngIf="!col.headerTemplate">
            <!-- default: checkbox -->
            <th
              *ngIf="col.field == 'checkbox' && isUseCheckbox"
              scope="col"
              [ngStyle]="col.headerStyle || col.style || { width: '50px' }"
              [ngClass]="col.headerStyleClass || col.styleClass"
            >
              <input type="checkbox" class="form-control" formControlName="checkboxPageAll" (change)="checkboxPageAllChanged()" />
            </th>

            <!-- default: normal -->
            <th
              *ngIf="col.field != 'checkbox'"
              scope="col"
              columnSorting
              [ngStyle]="col.headerStyle || col.style"
              [ngClass]="col.headerStyleClass || col.styleClass"
              [class.sorting]="col.sortable"
              [field]="col.field"
              [sortable]="col.sortable"
              (sort)="onSorted($event)"
            >
              {{ col.headerName }}
            </th>
          </ng-container>

          <!-- method 2: custom in column -->
          <ng-container *ngIf="col.headerTemplate">
            <ng-container *ngTemplateOutlet="col.headerTemplate; context: { $implicit: col }"></ng-container>
          </ng-container>
        </ng-container>
      </tr>

      <!-- method 3: custom in row -->
      <ng-container *ngIf="headerTemplate">
        <ng-container *ngTemplateOutlet="headerTemplate; context: { $implicit: columns }"></ng-container>
      </ng-container>
    </thead>
    <!-- endregion -->

    <!-- region table body -->
    <tbody [ngClass]="tbodyStyleClass">
      <!-- No Content -->
      <tr *ngIf="!isHasContent">
        <td [attr.colspan]="columns.length" class="text-center">{{ messageNoContent }}</td>
      </tr>

      <ng-container *ngIf="isHasContent">
        <ng-container *ngIf="!bodyTemplate" formArrayName="checkboxPageItems">
          <tr *ngFor="let item of data.content; index as id">
            <ng-container *ngFor="let col of columns">
              <!-- method 1: default -->
              <ng-container *ngIf="!col.bodyTemplate">
                <!-- default: show content checkbox -->
                <th
                  *ngIf="col.field == 'checkbox' && isUseCheckbox"
                  [ngStyle]="col.bodyStyle || col.style"
                  [ngClass]="col.bodyStyleClass || col.styleClass"
                >
                  <input type="checkbox" class="form-control" [formControlName]="id" (change)="checkboxItemChanged(id, item)" />
                </th>

                <!-- default: show content number record -->
                <th
                  scope="row"
                  *ngIf="col.field == 'recordNo'"
                  [ngStyle]="col.bodyStyle || col.style"
                  [ngClass]="col.bodyStyleClass || col.styleClass"
                >
                  {{ id | recordNoPaging: data }}
                </th>

                <!-- default: show content normal -->
                <td
                  *ngIf="col.field != 'recordNo' && col.field != 'checkbox'"
                  [ngStyle]="col.bodyStyle || col.style"
                  [ngClass]="col.bodyStyleClass || col.styleClass"
                >
                  {{ item[col.field] }}
                </td>
              </ng-container>

              <!-- method 2: custom in column -->
              <ng-container *ngIf="col.bodyTemplate">
                <ng-container *ngTemplateOutlet="col.bodyTemplate; context: { $implicit: col, item: item }"></ng-container>
              </ng-container>
            </ng-container>
          </tr>
        </ng-container>
        <!-- method 3: custom in row -->
        <ng-container *ngIf="bodyTemplate">
          <ng-container *ngTemplateOutlet="bodyTemplate; context: { $implicit: columns, data: data.content }"></ng-container>
        </ng-container>
      </ng-container>
    </tbody>
    <!-- endregion -->
  </table>
</div>
<!-- endregion  -->

<!-- region datatable footer: pagination, total elements -->
<datatable-footer
  [showTotalEntries]="showTotalEntries"
  [showPagination]="showPagination"
  [sizeOfPage]="pageRequest?.size"
  [data]="data"
  [isDisabled]="isDisabled"
  (onChangedPage)="onChangedPage($event)"
></datatable-footer>
<!-- endregion  -->
